var app=angular.module("app",["jcs-autoValidate","ngFileUpload","selectize"]);angular.module("jcs-autoValidate").run(["defaultErrorMessageResolver",function(t){t.getErrorMessages().then(function(t){t.patternInt="Please fill a numeric value",t.patternFloat="Please fill a numeric/decimal value"})}]),app.directive("convertToNumber",function(){return{require:"ngModel",link:function(t,e,a,o){o.$parsers.push(function(t){return null!=t?parseInt(t,10):null}),o.$formatters.push(function(t){return null!=t?""+t:null})}}}),app.service("DBService",function(a,t){this.getCall=function(t){return a({method:"GET",url:base_url+t,headers:{apiToken:api_key}}).then(function(t){if(console.log(t),200==t.status)return t.data.success,t.data})},this.postCall=function(t,e){return a({method:"POST",url:base_url+e,data:t,headers:{apiToken:api_key}}).then(function(t){if(200==t.status)return t.data.success,t.data})}}),app.controller("superDashboardCtrl",function(t,e,a,o,n,i){}),app.controller("clientsCtrl",function(e,t,a,o,n,i){e.clients=[],e.client={services:[{demo:""}]},e.client_id=0,e.init=function(){o.postCall({},"/api/superAdmin/get-clients").then(t=>{t.success&&(e.clients=t.clients)})},e.addClient=function(){o.postCall({client_id:e.client_id},"/api/superAdmin/edit-init").then(t=>{t.success&&(e.client=t.client),e.services=t.services})},e.addService=function(){e.client.services.push({demo:""})},e.removeService=function(t){1==confirm("Are you sure?")&&e.client.services.splice(t,1)},e.storeClient=function(){o.postCall(e.client,"/api/superAdmin/store-client").then(t=>{alert(t.message),t.success&&e.addClient()})}}),app.controller("cloackCtrl",function(n,t,e,a,i,o){n.loading=!1,n.aadhar_flag=!1,n.aadhar_fetch=!1,n.aadhar_upload_flag=!1,n.newAadharFlag=!1,n.users=[],n.filter={page_no:1,export:0},n.aadhar_details={},n.formData={name:"",mobile:"",total_amount:0,paid_amount:0,balance_amount:0,hours_occ:0,check_in:"",check_out:"",no_of_bag:0,no_of_day:""},n.type=0,n.entry_id=0,n.check_shift="",n.pay_types=[],n.days=[],n.cloak_first_rate=0,n.cloak_second_rate=0,n.excel_loading="",n.d_count=0,n.productName="",n.init=function(){n.aadhar_fetch=!1,n.aadhar_flag=!1,n.newAadharFlag=!1,a.postCall(n.filter,"/api/cloak-rooms/init/"+n.type).then(t=>{t.success&&(n.pay_types=t.pay_types,n.l_entries=t.l_entries,n.days=t.days,n.cloak_first_rate=t.rate_list.first_rate,n.cloak_second_rate=t.rate_list.second_rate,n.d_count=t.d_count,1==n.type&&n.updateCheckoutClass(),n.users=t.users,t.excel_link)&&(n.excel_loading=!1,window.open(t.excel_link,"_blank"))}),n.productName="",$("#productName").focus()},n.getData=t=>{n.filter.page_no=n.filter.page_no+t,n.init()},n.export=()=>{n.type=1,""!=n.filter.from_date&&""!=n.filter.to_date?(n.filter.export=1,n.excel_loading=!0,n.init()):alert("Please select both date")},n.filterClear=function(){n.filter={page_no:1,export:0},n.init()},n.edit=function(t){n.entry_id=t,a.postCall({entry_id:n.entry_id},"/api/cloak-rooms/edit-init").then(t=>{t.success&&(n.formData=t.l_entry,$("#exampleModalCenter").modal("show"))})},n.checkoutCloak=function(t){n.entry_id=t,1==confirm("Are you sure?")&&a.postCall({entry_id:n.entry_id},"/api/cloak-rooms/checkout-init/1").then(t=>{t.timeOut?(n.formData=t.l_entry,n.formData.checkout_by="",$("#checkoutCloakModel").modal("show")):(n.init(),n.filter.id="",alert(t.message))})},n.checkoutCloak1=function(){a.postCall({productName:n.productName},"/api/cloak-rooms/checkout-init/2").then(t=>{n.productName="",t.timeOut?(n.formData=t.l_entry,n.entry_id=t.l_entry.id,$("#checkoutCloakModel").modal("show")):(n.init(),alert(t.message),n.filter.id="")})},n.handleKeyPress=function(t){13===t.which?(n.checkoutCloak1(),n.scannedValue.trim()&&(n.scannedValue="")):n.scannedValue=(n.scannedValue||"")+t.key},n.add=function(){n.entry_id=0,$("#exampleModalCenter").modal("show")},n.hideModal=()=>{n.entry_id=0,n.formData={name:"",mobile:"",total_amount:0,paid_amount:0,balance_amount:0,hours_occ:0,check_in:"",check_out:"",no_of_bag:0,no_of_day:""},n.aadhar_fetch=!1,n.newAadharFlag=!1,n.aadhar_flag=!1,$("#exampleModalCenter").modal("hide"),$("#checkoutCloakModel").modal("hide")},n.onSubmit=function(){n.loading=!0,n.aadhar_fetch=!1,n.aadhar_flag=!1,n.newAadharFlag=!1,a.postCall(n.formData,"/api/cloak-rooms/store").then(t=>{t.success&&(n.loading=!1,$("#exampleModalCenter").modal("hide"),n.entry_id=0,n.formData={name:"",mobile:"",total_amount:0,paid_amount:0,balance_amount:0,hours_occ:0,check_in:"",check_out:"",no_of_bag:0,no_of_day:""},n.init(),setTimeout(function(){window.open(base_url+"/admin/cloak-rooms/print-unq/1/"+t.print_id,"_blank")},800)),n.loading=!1})},n.onCheckOut=function(){n.loading=!0,a.postCall(n.formData,"/api/cloak-rooms/checkout-store").then(t=>{t.success&&($("#checkoutCloakModel").modal("hide"),n.entry_id=0,n.formData={name:"",mobile:"",total_amount:0,paid_amount:0,balance_amount:0,hours_occ:0,check_in:"",check_out:"",no_of_bag:0,no_of_day:""},n.init(),setTimeout(function(){window.open(base_url+"/admin/cloak-rooms/print/"+t.id,"_blank")},800)),n.loading=!1,n.aadhar_fetch=!1,n.newAadharFlag=!1,n.aadhar_flag=!1})},n.changeAmount=function(){var t=n.cloak_first_rate,t=1<n.formData.no_of_day?(t+=(n.formData.no_of_day-1)*n.cloak_second_rate)*n.formData.no_of_bag:t*n.formData.no_of_day*n.formData.no_of_bag;0==n.entry_id?n.formData.paid_amount=t:n.formData.balance_amount=t-n.formData.paid_amount},n.delete=function(t){1==confirm("Are you sure?")&&a.getCall("/api/cloak-rooms/delete/"+t).then(t=>{alert(t.message),n.init()})},n.fetchAadhar=function(){n.formData.aadhar_no&&(n.aadhar_fetch=!0,a.postCall(n.formData,"/api/aadhar/fetch").then(t=>{t.success?(n.newAadharFlag=t.newAadharFlag,n.aadhar_details=t.details,console.log(t.details),n.newAadharFlag||(n.formData.aadhar_no=n.aadhar_details.aadhar_no,n.formData.name=n.aadhar_details.name,n.formData.mobile_no=+n.aadhar_details.mobile,n.aadhar_details.front?(n.formData.aadhar_front=n.aadhar_details.front,n.formData.aadhar_front_url=base_url+"/public/"+n.aadhar_details.front,n.formData.aadhar_back=n.aadhar_details.back,n.formData.aadhar_back_url=base_url+"/public/"+n.aadhar_details.back):n.newAadharFlag=!0),n.aadhar_flag=!0):n.aadhar_fetch=!1}))},n.uploadFile=function(t,e,a){a.pic_upload=!0;var o=base_url+"/api/aadhar/file-upload";i.upload({url:o,data:{media:t,name:e}}).then(function(t){t.data.success?(a[e]=t.data.path,a[e+"_url"]=t.data.url):alert(t.data.message),a.pic_upload=!1},function(t){console.log("Error status: "+t.status),a.pic_upload=!1},function(t){n.uploading_percentage=parseInt(100*t.loaded/t.total)+"%"})},n.removeFile=function(t,e){t[e]=""},n.updateCheckoutDarkClass=function(){for(var t=(new Date).getTime(),e=Math.floor(t/1e3),a=0;a<n.l_entries.length;a++)n.l_entries[a].check_class="",0==n.l_entries[a].checkout_status&&(e>n.l_entries[a].str_checkout_time?n.l_entries[a].check_class="t-danger":e+600>n.l_entries[a].str_checkout_time?n.l_entries[a].check_class="t-warning":n.l_entries[a].check_class="t-info")},n.updateCheckoutClass=function(){for(var t=(new Date).getTime(),e=Math.floor(t/1e3),a=0;a<n.l_entries.length;a++)n.l_entries[a].check_class="",0==n.l_entries[a].checkout_status&&(e>n.l_entries[a].str_checkout_time?n.l_entries[a].check_class="text-danger":e+600>n.l_entries[a].str_checkout_time?n.l_entries[a].check_class="text-warning":n.l_entries[a].check_class="")};var s=o(n.updateCheckoutClass,12e3);n.$on("$destroy",function(){s&&o.cancel(s)})}),app.controller("lockerCtrl",function(a,t,e,o){a.loading=!1,a.formData={name:"",mobile:"",paid_amount:0,no_of_day:"",locker_id:""},a.filter={},a.old_days=0,a.entry_id=0,a.check_shift="",a.pay_types=[],a.avail_lockers=[],a.days=[],a.rate_list={},a.sl_lockers=[],a.init=function(){o.postCall(a.filter,"/api/locker/init").then(t=>{t.success&&(a.pay_types=t.pay_types,a.l_entries=t.l_entries,a.avail_lockers=t.avail_lockers,a.days=t.days)})},a.filterClear=function(){a.filter={},a.init()},a.edit=function(t){a.entry_id=t,a.sl_lockers=[],o.postCall({entry_id:a.entry_id},"/api/locker/edit-init").then(t=>{t.success&&(a.formData=t.l_entry,a.sl_lockers=t.sl_lockers,a.rate_list=t.rate_list,a.old_days=t.l_entry.no_of_day,$("#exampleModalCenter").modal("show"))})},a.checkoutLoker=function(t,e){a.entry_id=t,1==confirm("Are you sure?")&&o.postCall({entry_id:a.entry_id,freePenalty:e},"/api/locker/checkout-init").then(t=>{t.timeOut?(a.formData=t.l_entry,$("#checkoutLokerModel").modal("show")):a.init()})},a.add=function(){a.entry_id=0,a.sl_lockers=[],o.postCall({entry_id:0},"/api/locker/edit-init").then(t=>{a.rate_list=t.rate_list,$("#exampleModalCenter").modal("show")})},a.hideModal=()=>{$("#exampleModalCenter").modal("hide"),$("#checkoutLokerModel").modal("hide"),a.entry_id=0,a.formData={name:"",mobile:"",total_amount:0,paid_amount:0,balance_amount:0}},a.onSubmit=function(){a.loading=!0,0==a.sl_lockers.length?alert("Please select at least one locker"):(a.formData.sl_lockers=a.sl_lockers,o.postCall(a.formData,"/api/locker/store").then(t=>{t.success&&(a.loading=!1,$("#exampleModalCenter").modal("hide"),a.entry_id=0,a.formData={name:"",mobile:"",paid_amount:0,no_of_day:"",locker_id:""},a.init(),setTimeout(function(){window.open(base_url+"/admin/locker/print/"+t.id,"_blank")},800)),a.loading=!1}))},a.onCheckOut=function(){a.loading=!0,o.postCall(a.formData,"/api/locker/checkout-store").then(t=>{t.success&&($("#checkoutLokerModel").modal("hide"),a.entry_id=0,a.formData={name:"",mobile:"",total_amount:0,paid_amount:0,balance_amount:0,hours_occ:0,check_in:"",check_out:""},a.init()),a.loading=!1})},a.changeAmount=function(){var t=a.rate_list.first_rate;1<a.formData.no_of_day&&(t+=(a.formData.no_of_day-1)*a.rate_list.second_rate),t=a.sl_lockers.length*t,0==a.entry_id?a.formData.paid_amount=t:a.formData.balance_amount=t-a.formData.paid_amount},a.delete=function(t){1==confirm("Are you sure?")&&o.getCall("/api/locker/delete/"+t).then(t=>{alert(t.message),a.init()})},a.insLocker=t=>{var e=a.sl_lockers.indexOf(t);-1==e?a.sl_lockers.push(t):a.sl_lockers.splice(e,1),a.changeAmount()}}),app.controller("massageCtrl",function(e,t,a,o){e.loading=!1,e.formData={paid_amount:0,time_period:"",no_of_person:1},e.filter={},e.m_id=0,e.m_entries=[],e.rate_list={},e.init=function(){o.postCall(e.filter,"/api/massage/init").then(t=>{e.pay_types=t.pay_types,e.m_entries=t.m_entries,e.rate_list=t.rate_list})},e.filterClear=function(){e.filter={},e.init()},e.edit=function(t){e.m_id=t,o.postCall({m_id:e.m_id},"/api/massage/edit-init").then(t=>{t.success&&(e.formData=t.m_entry,$("#massageModal").modal("show"))})},e.add=function(){$("#massageModal").modal("show")},e.hideModal=()=>{$("#massageModal").modal("hide"),e.entry_id=0,e.formData={paid_amount:0,time_period:0,no_of_person:1},e.init()},e.changeTime=function(){e.formData.paid_amount=0,10==e.formData.time_period&&(e.formData.paid_amount=e.rate_list.first_rate*e.formData.no_of_person),20==e.formData.time_period&&(e.formData.paid_amount=e.rate_list.second_rate*e.formData.no_of_person)},e.onSubmit=function(){e.loading=!0,o.postCall(e.formData,"/api/massage/store").then(t=>{t.success&&($("#massageModal").modal("hide"),e.entry_id=0,e.formData={paid_amount:0,time_period:0,no_of_person:1},e.init(),setTimeout(function(){window.open(base_url+"/admin/massage/print/"+t.id,"_blank")},800)),e.loading=!1})},e.delete=function(t){1==confirm("Are you sure")&&o.getCall("/api/massage/delete/"+t).then(t=>{alert(t.message),e.init()})}}),app.controller("sittingCtrl",function(o,t,e,a,n){o.loading=!1,o.formData={id:"",no_of_adults:0,no_of_baby_staff:0,no_of_children:0,name:"",mobile:"",total_amount:0,paid_amount:0,balance_amount:0,hours_occ:""},o.last_hour=1,o.filter={},o.checkout_number="",o.entry_id=0,o.pay_types=[],o.hours=[],o.rate_list={},o.checkout_process=!1,o.productName="",o.old_hr=0,o.checkout_th=0,o.setNullFormData=function(){o.formData={id:"",no_of_adults:0,no_of_baby_staff:0,no_of_children:0,name:"",mobile:"",total_amount:0,paid_amount:0,balance_amount:0,hours_occ:""},o.last_hour=1,o.old_hr=0},o.init=function(){o.setNullFormData(),a.postCall(o.filter,"/api/sitting/init").then(t=>{t.success&&(o.pay_types=t.pay_types,o.hours=t.hours,o.entries=t.entries,o.rate_list=t.rate_list,o.updateCheckoutClass()),$("#productName").focus()})},o.filterClear=function(){o.filter={},o.init()},o.edit=function(t){o.checkout_process=!1,o.entry_id=t,o.setNullFormData(),a.postCall({entry_id:o.entry_id},"/api/sitting/edit-init").then(t=>{t.success&&(o.last_hour=t.sitting_entry.hours_occ,o.formData=t.sitting_entry,o.old_hr=t.sitting_entry.hours_occ,$("#exampleModalCenter").modal("show"))})},o.newEditCheckout=function(t){o.checkout_th=1,o.entry_id=t,1==confirm("Are you sure?")&&(o.setNullFormData(),a.postCall({checkout_id:t,checkout_th:o.checkout_th},"/api/sitting/checkout-new/1").then(t=>{t.success?(alert(t.message),o.init(),o.checkout_th=0):(o.formData=t.entry,o.checkout_process=!0,setTimeout(function(){$("#checkoutModal").modal("show")},800))}))},o.newEditCheckout1=function(){o.checkout_th=2,o.setNullFormData(),a.postCall({productName:o.productName,checkout_th:o.checkout_th},"/api/sitting/checkout-new/2").then(t=>{o.productName="",$checkout_loading=!1,t.success?(alert(t.message),o.init(),o.checkout_th=0):(o.entry_id=t.entry.id,o.formData=t.entry,o.checkout_process=!0,setTimeout(function(){$("#checkoutModal").modal("show")},800))})},o.handleKeyPress=function(t){13===t.which?(o.newEditCheckout1(),o.scannedValue.trim()&&(o.scannedValue="")):o.scannedValue=(o.scannedValue||"")+t.key},o.add=function(){o.entry_id=0,o.setNullFormData(),o.checkout_process=!1,$("#exampleModalCenter").modal("show")},o.hideModal=()=>{o.entry_id=0,o.checkout_process=!1,o.setNullFormData(),$("#exampleModalCenter").modal("hide"),$("#checkoutModal").modal("hide")},o.onSubmit=function(){o.loading=!0,a.postCall(o.formData,"/api/sitting/store").then(t=>{t.success?($("#exampleModalCenter").modal("hide"),$("#checkoutModal").modal("hide"),o.entry_id=0,o.setNullFormData(),o.last_hour=1,o.init(),setTimeout(function(){window.open(base_url+"/admin/sitting/print-unq/1/"+t.print_id,"_blank")},800),o.checkout_process=!1):alert(t.message),o.loading=!1})},o.onSubmitCheckout=function(){o.loading=!0,o.formData.checkout_th=o.checkout_th,a.postCall(o.formData,"/api/sitting/checkout-store").then(t=>{t.success?($("#exampleModalCenter").modal("hide"),$("#checkoutModal").modal("hide"),o.entry_id=0,o.new_checkout_id=0,o.productName="",o.setNullFormData(),o.last_hour=1,o.checkout_th=0,o.init(),setTimeout(function(){window.open(base_url+"/admin/sitting/print-unq/2/"+t.print_id,"_blank")},800),o.checkout_process=!1):alert(t.message),o.loading=!1})},o.changeAmount=function(){var t;(o.formData.total_amount=0)<o.formData.hours_occ&&(t=o.formData.hours_occ-1,0<o.formData.no_of_adults&&(o.formData.total_amount+=o.rate_list.adult_rate*o.formData.no_of_adults,o.formData.total_amount+=t*o.rate_list.adult_rate_sec*o.formData.no_of_adults,console.log(o.formData.total_amount)),0<o.formData.no_of_children)&&(o.formData.total_amount+=o.rate_list.child_rate*o.formData.no_of_children,o.formData.total_amount+=t*o.rate_list.child_rate_sec*o.formData.no_of_children,console.log(o.formData.total_amount)),o.formData.balance_amount=o.formData.total_amount-o.formData.paid_amount,o.geValTime()},o.geValTime=function(){a.postCall({entry_id:o.entry_id,hours_occ:o.formData.hours_occ},"/api/sitting/cal-check").then(t=>{t.success&&(o.formData.show_valid_up=t.show_valid_up)})},o.updateCheckoutClass=function(){var t=(new Date).getTime(),e=(console.log(t+"mm second"),Math.floor(t/1e3));console.log(e+"uu second");for(var a=0;a<o.entries.length;a++)o.entries[a].check_class="",0==o.entries[a].checkout_status&&(e>o.entries[a].str_checkout_time?o.entries[a].check_class="t-danger":e+600>o.entries[a].str_checkout_time?o.entries[a].check_class="t-warning":o.entries[a].check_class="t-info")};var i=n(o.updateCheckoutClass,12e3);o.$on("$destroy",function(){i&&n.cancel(i)})}),app.controller("reclinerCtrl",function(o,t,e,a,n){o.loading=!1,o.formData={id:"",no_of_adults:0,no_of_baby_staff:0,no_of_children:0,name:"",mobile:"",total_amount:0,paid_amount:0,balance_amount:0,hours_occ:""},o.last_hour=1,o.filter={},o.checkout_number="",o.entry_id=0,o.pay_types=[],o.hours=[],o.rate_list={},o.checkout_process=!1,o.productName="",o.old_hr=0,o.checkout_th=0,o.avail_recliners=[],o.sl_recliners=[],o.setNullFormData=function(){o.formData={id:"",no_of_adults:0,no_of_baby_staff:0,no_of_children:0,name:"",mobile:"",total_amount:0,paid_amount:0,balance_amount:0,hours_occ:""},o.last_hour=1,o.old_hr=0,o.sl_recliners=[]},o.init=function(){o.setNullFormData(),a.postCall(o.filter,"/api/recliners/init").then(t=>{t.success&&(o.pay_types=t.pay_types,o.hours=t.hours,o.entries=t.entries,o.rate_list=t.rate_list,o.avail_recliners=t.avail_recliners,o.updateCheckoutClass()),$("#productName").focus()})},o.filterClear=function(){o.filter={},o.init()},o.edit=function(t){o.checkout_process=!1,o.entry_id=t,o.setNullFormData(),a.postCall({entry_id:o.entry_id},"/api/recliners/edit-init").then(t=>{t.success&&(o.last_hour=t.rec_entry.hours_occ,o.formData=t.rec_entry,o.old_hr=t.rec_entry.hours_occ,o.sl_recliners=t.sl_recliners,$("#exampleModalCenter").modal("show"))})},o.newEditCheckout=function(t){o.checkout_th=1,o.entry_id=t,1==confirm("Are you sure?")&&(o.setNullFormData(),a.postCall({checkout_id:t,checkout_th:o.checkout_th},"/api/recliners/checkout-new/1").then(t=>{t.success?(alert(t.message),o.init(),o.checkout_th=0):(o.formData=t.entry,o.checkout_process=!0,setTimeout(function(){$("#checkoutModal").modal("show")},800))}))},o.newEditCheckout1=function(){o.checkout_th=2,o.setNullFormData(),a.postCall({productName:o.productName,checkout_th:o.checkout_th},"/api/recliners/checkout-new/2").then(t=>{o.productName="",$checkout_loading=!1,t.success?(alert(t.message),o.init(),o.checkout_th=0):(o.entry_id=t.entry.id,o.formData=t.entry,o.checkout_process=!0,setTimeout(function(){$("#checkoutModal").modal("show")},800))})},o.handleKeyPress=function(t){13===t.which?(o.newEditCheckout1(),o.scannedValue.trim()&&(o.scannedValue="")):o.scannedValue=(o.scannedValue||"")+t.key},o.add=function(){o.entry_id=0,o.setNullFormData(),o.checkout_process=!1,$("#exampleModalCenter").modal("show")},o.hideModal=()=>{o.entry_id=0,o.checkout_process=!1,o.setNullFormData(),$("#exampleModalCenter").modal("hide"),$("#checkoutModal").modal("hide")},o.onSubmit=function(){0==o.sl_recliners.length?alert("Please select at least one Recliner"):(o.formData.sl_recliners=o.sl_recliners,o.loading=!0,a.postCall(o.formData,"/api/recliners/store").then(t=>{t.success?($("#exampleModalCenter").modal("hide"),$("#checkoutModal").modal("hide"),o.entry_id=0,o.setNullFormData(),o.last_hour=1,o.init(),setTimeout(function(){window.open(base_url+"/admin/recliners/print-unq/1/"+t.print_id,"_blank")},800),o.checkout_process=!1):alert(t.message),o.loading=!1}))},o.onSubmitCheckout=function(){o.loading=!0,o.formData.checkout_th=o.checkout_th,a.postCall(o.formData,"/api/recliners/checkout-store").then(t=>{t.success?($("#exampleModalCenter").modal("hide"),$("#checkoutModal").modal("hide"),o.entry_id=0,o.new_checkout_id=0,o.productName="",o.setNullFormData(),o.last_hour=1,o.checkout_th=0,o.init(),setTimeout(function(){window.open(base_url+"/admin/recliners/print-unq/2/"+t.print_id,"_blank")},800),o.checkout_process=!1):alert(t.message),o.loading=!1})},o.changeAmount=function(){var t;(o.formData.total_amount=0)<o.formData.hours_occ&&(t=o.formData.hours_occ-1,o.formData.total_amount+=o.rate_list.second_rate*o.sl_recliners.length,o.formData.total_amount+=t*o.rate_list.second_rate*o.sl_recliners.length),o.formData.balance_amount=o.formData.total_amount-o.formData.paid_amount,o.geValTime()},o.geValTime=function(){a.postCall({entry_id:o.entry_id,hours_occ:o.formData.hours_occ},"/api/recliners/cal-check").then(t=>{t.success&&(o.formData.show_valid_up=t.show_valid_up)})},o.updateCheckoutClass=function(){for(var t=(new Date).getTime(),e=Math.floor(t/1e3),a=0;a<o.entries.length;a++)o.entries[a].check_class="",0==o.entries[a].checkout_status&&(e>o.entries[a].str_checkout_time?o.entries[a].check_class="t-danger":e+600>o.entries[a].str_checkout_time?o.entries[a].check_class="t-warning":o.entries[a].check_class="t-info")};var i=n(o.updateCheckoutClass,12e3);o.$on("$destroy",function(){i&&n.cancel(i)}),o.insRec=t=>{console.log(t);var e=o.sl_recliners.indexOf(t);-1==e?o.sl_recliners.push(t):o.sl_recliners.splice(e,1),o.changeAmount()}}),app.controller("shiftCtrl",function(e,t,a,o){e.loading=!1,e.data_rows=[],e.service_ids=[],e.clients=[],e.filter={input_date:"",user_id:"",client_id:""},e.clear=function(){e.filter={input_date:"",user_id:"",client_id:""},e.init()},e.changeFilter=function(){e.filter.user_id="",e.init()},e.serach=function(){e.init()},e.users=[],e.init=function(){e.loading=!1,o.postCall(e.filter,"/api/shift/init").then(t=>{t.success&&(e.users=t.users,e.clients=t.clients,e.service_ids=t.service_ids,e.data_rows=t.data_rows,e.total_shift_upi=t.total_shift_upi,e.total_shift_cash=t.total_shift_cash,e.total_collection=t.total_collection,e.last_hour_upi_total=t.last_hour_upi_total,e.last_hour_cash_total=t.last_hour_cash_total,e.last_hour_total=t.last_hour_total,e.change_data=t.chage_pay_type_data,e.check_shift=t.check_shift,e.shift_date=t.shift_date),e.loading=!0})}}),app.controller("userCtrl",function(o,t,e,n){o.loading=!1,o.add_new_flag=!1,o.formData={name:"",email:"",mobile:"",password:"",confirm_password:""},o.filter={},o.user_id=0,o.users=[],o.init=function(){n.postCall(o.filter,"/api/users/init").then(t=>{o.users=t.users,o.add_new_flag=t.add_new_flag})},o.filterClear=function(){o.filter={},o.init()},o.edit=function(t){o.user_id=t,n.postCall({user_id:o.user_id},"/api/users/edit-init").then(t=>{t.success&&(o.formData=t.user,$("#userModal").modal("show"))})},o.activeUser=function(e,a){1==confirm("Are you sure?")&&n.postCall({user_id:e.id},"/api/users/active-user").then(t=>{t.success&&(o.users[a].active=0==e.active?1:0),alert(t.message)})},o.hideModal=()=>{$("#userModal").modal("hide"),o.user_id=0,o.formData={name:"",email:"",mobile:"",password:"",confirm_password:""},o.init()},o.add=()=>{$("#userModal").modal("show"),o.user_id=0,o.formData={name:"",email:"",mobile:"",password:"",confirm_password:""}},o.onSubmit=function(){o.loading=!0,n.postCall(o.formData,"/api/users/store").then(t=>{t.success?(alert(t.message),$("#userModal").modal("hide"),o.formData={name:"",email:"",mobile:"",password:"",confirm_password:""},o.init()):alert(t.message),o.loading=!1})}}),app.controller("canteenItemsCtrl",function(e,t,a,o){e.loading=!1,e.formData={item_name:"",item_short_name:"",price:"",barcodevalue:""},e.stockData={stock:""},e.filter={barcodevalue_search:""},e.canteen_item_id=0,e.canteen_item_stock_id=0,e.canteen_items=[],e.init=function(){o.postCall(e.filter,"/api/canteen-items/init").then(t=>{e.canteen_items=t.canteen_items,$("#barcodevalue").focus()})},e.filterClear=function(){e.filter={barcodevalue_search:""},e.init()},e.edit=function(t){e.canteen_item_id=t,o.postCall({canteen_item_id:e.canteen_item_id},"/api/canteen-items/edit").then(t=>{t.success&&(e.formData=t.canteen_item,$("#exampleModalCenter").modal("show"))})},e.hideModal=()=>{$("#exampleModalCenter").modal("hide"),e.canteen_item_id=0,e.formData={item_name:"",item_short_name:"",price:"",barcodevalue:""},e.init()},e.add=()=>{e.canteen_item_id=0,e.formData={item_name:"",item_short_name:"",price:""},$("#barcodevalue").focus(),setTimeout(function(){$("#exampleModalCenter").modal("show")},300)},e.onSubmit=function(){console.log(e.formData),e.loading=!0,o.postCall(e.formData,"/api/canteen-items/store").then(t=>{t.success?(alert(t.message),$("#exampleModalCenter").modal("hide"),e.formData={item_name:"",item_short_name:"",price:"",barcodevalue:""},e.init()):alert(t.message),e.loading=!1})},e.initStocks=function(){e.filter.canteen_item_id=e.canteen_item_id,console.log(e.filter+"hello"),o.postCall(e.filter,"/api/canteen-items/stocks/init").then(t=>{e.item_stocks=t.item_stocks})},e.hideStockModal=()=>{$("#stockModal").modal("hide"),e.stockData={stock:""},e.initStocks()},e.addStock=()=>{$("#stockModal").modal("show"),e.stockData={stock:""}},e.editStock=function(t){e.canteen_item_stock_id=t,o.postCall({canteen_item_stock_id:e.canteen_item_stock_id},"/api/canteen-items/stocks/edit").then(t=>{t.success&&(e.stockData=t.item_stock,$("#stockModal").modal("show"))})},e.onStockSubmit=function(){e.loading=!0,e.stockData.canteen_item_id=e.canteen_item_id,o.postCall(e.stockData,"/api/canteen-items/stocks/store").then(t=>{t.success?(alert(t.message),$("#stockModal").modal("hide"),e.stockData={stock:""},e.initStocks()):alert(t.message),e.loading=!1})}}),app.controller("dailyEntryCtrl",function(s,t,e,a){s.loading=!1,s.formData={name:"",mobile:"",pay_type:"",total_amount:0,total_item:0,products:[{demo:""}]},s.products=[],s.product={canteen_item_id:0,item_name:"",quantity:1},s.filter={},s.entry_id=0,s.daily_entries=[],s.canteen_items=[],s.selectConfig={valueField:"barcodevalue",labelField:"item_name",maxItems:1,searchField:"item_name",create:!1,onInitialize:function(t){}},s.setNull=()=>{s.entry_id=0,s.formData={name:"",mobile:"",pay_type:"",total_amount:0,total_item:0,products:[{demo:""}]},s.products=[],s.product={canteen_item_id:0,item_name:"",quantity:1},s.productname=""},s.init=function(){a.postCall(s.filter,"/api/daily-entries/init").then(t=>{s.daily_entries=t.daily_entries,s.canteen_items=t.canteen_items,$("#productname").focus(),s.setNull()})},s.filterClear=function(){s.filter={},s.init()},s.edit=function(t){s.setNull(),s.entry_id=t,a.postCall({entry_id:s.entry_id},"/api/daily-entries/edit-init").then(t=>{t.success&&(s.formData=t.s_entry,$("#exampleModalCenter").modal("show"))})},s.hideModal=()=>{$("#exampleModalCenter").modal("hide"),s.entry_id=0,s.init()},s.add=()=>{$("#productname").focus(),s.setNull(),setTimeout(function(){$("#exampleModalCenter").modal("show")},300)},s.onSubmit=function(){s.formData.products=s.products,0==s.products.length?alert("Plese select at least one item."):""==s.formData.pay_type?alert("Plese select the pay type"):0==s.formData.total_amount?alert("Please select at least one item"):(s.loading=!0,a.postCall(s.formData,"/api/daily-entries/store").then(t=>{t.success?(alert(t.message),$("#exampleModalCenter").modal("hide"),s.products=[],s.init(),setTimeout(function(){window.open(base_url+"/admin/daily-entries/print/"+t.entry_id,"_blank")},800)):alert(t.message),s.loading=!1}))},s.onAddProdcut=()=>{for(var t=s.products,e=s.canteen_items.find(t=>t.barcodevalue==s.productname),a=(0<t.length&&t.findIndex(t=>t.barcodevalue==s.productname),e.paid_amount=+e.price,e.quantity=1,t.push(e),s.product={canteen_item_id:0,item_name:"",quantity:1},s.products=t,0),o=0,n=0;n<s.products.length;n++){var i=s.products[n];a+=i.paid_amount,o+=i.quantity}s.formData.total_amount=a,s.formData.total_item=o,s.productname="",$("#productname").focus()},s.removeItem=t=>{s.product=s.products[t],s.formData.total_amount=s.formData.total_amount-s.product.paid_amount,s.formData.total_item=s.products.length-1,s.products.splice(t,1)},s.handleKeyPress=function(t){13===t.which?(s.onAddProdcut(),s.scannedValue.trim()&&(s.scannedValue="")):s.scannedValue=(s.scannedValue||"")+t.key}}),app.controller("cloackPenltyCollectCtrl",function(e,t,a,o){e.loading=!1,e.formData={id:0,no_of_bag:0,total_bag:0},e.pData={},e.init=function(){o.postCall(e.filter,"/api/collect-cloak/init").then(t=>{t.success&&(e.l_entries=t.l_entries,e.penlty_list=t.penlty_list,e.penalty_sum=t.penalty_sum,e.c_sum=t.c_sum)})},e.filterClear=function(){e.filter={},e.init()},e.collectCloak=function(t){e.formData.id=t.id,e.formData.total_bag=t.total_bag,e.formData.no_of_bag=t.no_of_bag,$("#exampleModalCenter").modal("show")},e.onSubmit=function(){e.loading=!0,o.postCall(e.formData,"/api/collect-cloak/store").then(t=>{t.success?(alert(t.message),$("#exampleModalCenter").modal("hide"),e.formData={id:0,no_of_bag:0,total_bag:0},e.init()):alert(t.message),e.loading=!1})},e.onPSubmit=function(t){e.ploading=!0,e.pData=t,o.postCall(e.pData,"/api/collect-cloak/store-pen").then(t=>{t.success?(alert(t.message),e.pData={},e.init()):alert(t.message),e.ploading=!1})}}),app.controller("sittingCollectCtrl",function(e,t,a,o){e.loading=!1,e.formData={id:0,no_of_bag:0,total_bag:0},e.checked={},e.pData={},e.entries=[],e.init=function(){o.postCall(e.filter,"/api/collect-sitting/init").then(t=>{t.success&&(e.entries=t.entries,e.e_entries_list=t.e_entries_list,e.c_sum=t.c_sum,e.e_ent_sum=t.e_ent_sum,e.checked=t.checked)})},e.filterClear=function(){e.filter={},e.init()},e.hideModal=()=>{$("#exampleModalCenter").modal("hide")},e.collectSit=function(t){e.formData.id=t.id,e.formData.total_no_of_adults=t.no_of_adults,e.formData.no_of_adults=t.no_of_adults,e.formData.total_no_of_children=t.no_of_children,e.formData.no_of_children=t.no_of_children,e.formData.hours_occ=t.hours_occ,e.formData.total_hours=t.total_hours,$("#exampleModalCenter").modal("show")},e.onSubmit=function(){e.loading=!0,o.postCall(e.formData,"/api/collect-sitting/store").then(t=>{t.success?(alert(t.message),$("#exampleModalCenter").modal("hide"),e.formData={id:0,no_of_bag:0,total_bag:0},e.init()):alert(t.message),e.loading=!1})},e.onPSubmit=function(t){e.ploading=!0,e.pData=t,o.postCall(e.pData,"/api/collect-sitting/store-pen").then(t=>{t.success?(alert(t.message),e.pData={},e.init()):alert(t.message),e.ploading=!1})}}),app.controller("entryRoomCtrl",function(o,t,e,a,n){o.loading=!1,o.formData={name:"",mobile:"",paid_amount:0,no_of_day:"",locker_id:"",discount_amount:0},o.type=0,o.filter={},o.entry_id=0,o.check_shift="",o.pay_types=[],o.avail_pods=[],o.avail_cabins=[],o.avail_beds=[],o.hours=[],o.sl_pods=[],o.sl_cabins=[],o.sl_beds=[],o.total_amount=0,o.paid_amount=0,o.balance_amount=0,o.init=function(){a.postCall(o.filter,"/api/rooms/init/"+o.type).then(t=>{t.success&&(o.pay_types=t.pay_types,o.entries=t.entries,o.avail_pods=t.avail_pods,o.avail_cabins=t.avail_cabins,o.avail_beds=t.avail_beds,o.hours=t.hours,o.updateCheckoutClass())})},o.filterClear=function(){o.filter={},o.init()},o.edit=function(t){o.entry_id=t,o.sl_pods=[],o.sl_cabins=[],o.sl_beds=[],a.postCall({entry_id:o.entry_id},"/api/rooms/edit-init").then(t=>{t.success&&(console.log(t.l_entry.discount_amount+"hhhhh"),o.formData=t.l_entry,o.total_amount=t.l_entry.total_amount,o.sl_pods=t.sl_pods,o.sl_cabins=t.sl_cabins,o.sl_beds=t.sl_beds,$("#exampleModalCenter").modal("show"))})},o.checkoutLoker=function(t,e){o.entry_id=t,alert(e),1==confirm("Are you sure?")&&a.postCall({entry_id:o.entry_id,freePenalty:e},"/api/rooms/checkout-init").then(t=>{t.timeOut?(o.formData=t.l_entry,$("#checkoutModal").modal("show")):o.init()})},o.add=function(){o.entry_id=0,o.sl_pods=[],o.sl_cabins=[],o.sl_beds=[],o.formData={name:"",mobile:"",paid_amount:0,total_amount:0,balance_amount:0,hours_occ:"",discount_amount:0},$("#exampleModalCenter").modal("show")},o.hideModal=()=>{$("#exampleModalCenter").modal("hide"),$("#checkoutModal").modal("hide"),o.entry_id=0,o.formData={name:"",mobile:"",paid_amount:0,total_amount:0,balance_amount:0,hours_occ:"",discount_amount:0},o.sl_pods=[],o.sl_beds=[],o.sl_cabins=[]},o.onSubmit=function(){o.formData.type=o.type,1==o.type&&0==o.sl_pods.length?alert("Please select at least one pods"):2==o.type&&0==o.sl_cabins.length?alert("Please select at least one single cabins"):3==o.type&&0==o.sl_beds.length?alert("Please select at least one double bed"):(o.loading=!0,1==o.type&&(o.formData.sl_pods=o.sl_pods),2==o.type&&(o.formData.sl_cabins=o.sl_cabins),3==o.type&&(o.formData.sl_beds=o.sl_beds),a.postCall(o.formData,"/api/rooms/store/"+o.type).then(t=>{t.success&&(o.loading=!1,$("#exampleModalCenter").modal("hide"),o.entry_id=0,o.formData={name:"",mobile:"",paid_amount:0,total_amount:0,balance_amount:0,hours_occ:"",discount_amount:0},o.sl_pods=[],o.sl_beds=[],o.sl_cabins=[],o.init(),setTimeout(function(){window.open(base_url+"/admin/rooms/print/"+t.id,"_blank")},800)),o.loading=!1}))},o.onCheckOut=function(){o.loading=!0,a.postCall(o.formData,"/api/rooms/checkout-store").then(t=>{t.success&&($("#checkoutModal").modal("hide"),o.entry_id=0,o.formData={name:"",mobile:"",total_amount:0,paid_amount:0,balance_amount:0,hours_occ:0,check_in:"",check_out:"",discount_amount:0},o.init(),setTimeout(function(){window.open(base_url+"/admin/rooms/print/"+t.entry_id,"_blank")},800)),o.loading=!1})},o.changeAmount=()=>{1==o.type&&o.changeAmountPod(),2==o.type&&o.changeAmountCabin(),3==o.type&&o.changeAmountBed()},o.changeAmountPod=()=>{var t=0;6==o.formData.hours_occ?t=299*o.sl_pods.length:12==o.formData.hours_occ?t=499*o.sl_pods.length:24==o.formData.hours_occ&&(t=799*o.sl_pods.length),o.total_amount=t,o.formData.total_amount=t,0==o.entry_id?(0<o.formData.discount_amount?o.formData.paid_amount=t-o.formData.discount_amount:o.formData.paid_amount=t,o.formData.balance_amount=t-o.formData.paid_amount):o.formData.balance_amount=t-(o.formData.paid_amount+o.formData.discount_amount)},o.changeAmountCabin=()=>{var t=0;6==o.formData.hours_occ?t=399*o.sl_cabins.length:12==o.formData.hours_occ?t=599*o.sl_cabins.length:24==o.formData.hours_occ&&(t=1199*o.sl_cabins.length),o.total_amount=t,o.formData.total_amount=t,0==o.entry_id?(0<o.formData.discount_amount?o.formData.paid_amount=t-o.formData.discount_amount:o.formData.paid_amount=t,o.formData.balance_amount=t-o.formData.paid_amount):o.formData.balance_amount=t-(o.formData.paid_amount+o.formData.discount_amount)},o.changeAmountBed=()=>{var t=0;6==o.formData.hours_occ?t=599*o.sl_beds.length:12==o.formData.hours_occ?t=899*o.sl_beds.length:24==o.formData.hours_occ&&(t=1699*o.sl_beds.length),o.total_amount=t,o.formData.total_amount=t,0==o.entry_id?(0<o.formData.discount_amount?o.formData.paid_amount=t-o.formData.discount_amount:o.formData.paid_amount=t,o.formData.balance_amount=t-o.formData.paid_amount):o.formData.balance_amount=t-(o.formData.paid_amount+o.formData.discount_amount),o.balance_amount=o.formData.balance_amount},o.delete=function(t){1==confirm("Are you sure?")&&a.getCall("/api/rooms/delete/"+t).then(t=>{alert(t.message),o.init()})},o.insPods=t=>{var e=o.sl_pods.indexOf(t);-1==e?o.sl_pods.push(t):o.sl_pods.splice(e,1),o.changeAmountPod()},o.insCabins=t=>{var e=o.sl_cabins.indexOf(t);-1==e?o.sl_cabins.push(t):o.sl_cabins.splice(e,1),o.changeAmountCabin()},o.insBeds=t=>{var e=o.sl_beds.indexOf(t);-1==e?o.sl_beds.push(t):o.sl_beds.splice(e,1),o.changeAmountBed()},o.disAmount=()=>{var t;0<o.formData.discount_amount&&0<o.formData.total_amount&&(0==o.entry_id?o.formData.paid_amount=o.total_amount-o.formData.discount_amount:(t=parseInt(o.formData.paid_amount)+parseInt(o.formData.discount_amount),o.formData.balance_amount=o.total_amount-t))},o.updateCheckoutClass=function(){for(var t=(new Date).getTime(),e=Math.floor(t/1e3),a=0;a<o.entries.length;a++)o.entries[a].check_class="",0==o.entries[a].checkout_status&&(e>o.entries[a].str_checkout_time?o.entries[a].check_class="t-danger":e+1200>o.entries[a].str_checkout_time?o.entries[a].check_class="t-warning":o.entries[a].check_class="t-info")};var i=n(o.updateCheckoutClass,12e3);o.$on("$destroy",function(){i&&n.cancel(i)})}),app.controller("allRoomEntryCtrl",function(e,t,a,o){e.loading=!1,e.filter={},e.entries=[{}],$l_entry={},e.init=function(){o.postCall(e.filter,"/api/rooms/init-all").then(t=>{t.success&&(e.entries=t.entries)})},e.initSingleEntry=function(t){o.postCall({entry_id:t},"/api/rooms/init-single-entry").then(t=>{t.success&&(e.l_entry=t.l_entry,$("#viewModal").modal("show"))})},e.hideModal=function(){$("#viewModal").modal("hide")},e.deleteEntry=function(t,e){console.log(t,e),o.getCall("/api/rooms/delete-e-entry/"+t+"/"+e).then(t=>{t.success,$("#viewModal").modal("hide")})},e.filterClear=function(){e.filter={},e.init()}}),app.controller("clientSettingCtrl",function(e,t,a,o){e.loading=!1,e.processing=!1,e.filter={},e.clients=[],e.init=function(){o.postCall(e.filter,"/api/clients/init-amount-setting").then(t=>{t.success&&(e.clients=t.clients)})},e.onSubmit=function(){e.processing=!0,o.postCall({clients:e.clients},"/api/clients/store-amount-setting").then(t=>{t.success&&e.init(),alert(t.message),e.processing=!1})},e.shiftStatus=function(){e.processing=!0,o.postCall(e.filter,"/api/clients/shift-status").then(t=>{t.success&&(e.shift_rows=t.shift_rows)})}}),app.controller("scanningCtrl",function(e,t,a,o){e.loading=!1,e.processing=!1,e.filter={},e.entries=[],e.incoming_types=[],e.item_types=[],e.rate_list=[],e.formData={name:"",paid_amount:0},e.init=function(){o.postCall(e.filter,"/api/scanning/init").then(t=>{t.success&&(e.entries=t.entries,e.incoming_types=t.incoming_types,e.item_types=t.item_types,e.rate_list=t.rate_list)})},e.add=()=>{$("#exampleModalCenter").modal("show")},e.filterClear=function(){e.filter={},e.init()},e.hideModal=()=>{$("#exampleModalCenter").modal("hide"),e.formData.name="",e.formData.paid_amount=0},e.onSubmit=function(){e.processing=!0,o.postCall(e.formData,"/api/scanning/store").then(t=>{t.success?(e.init(),e.hideModal(),setTimeout(function(){window.open(base_url+"/admin/scanning/print/"+t.print_id,"_blank")},800)):alert(t.message),e.processing=!1})},e.calAmount=()=>{var t=e.rate_list.find(t=>t.item_type_id==e.formData.item_type_id&&t.incoming_type_id==e.formData.incoming_type_id);e.formData.paid_amount=e.formData.no_of_item*t.rate}}),app.controller("restCtrl",function(e,t,a,o){e.loading=!1,e.processing=!1,e.formData={pay_type:1,no_of_hours:1,no_of_people:1,paid_amount:0},e.filter={},e.entries=[],e.rate_list={},e.init=function(){o.postCall(e.filter,"/api/rest/init").then(t=>{t.success&&(e.pay_types=t.pay_types,e.entries=t.entries,e.rate_list=t.rate_list,e.formData.paid_amount=e.formData.no_of_hours*e.rate_list.first_rate)})},e.filterClear=function(){e.filter={},e.init()},e.calAmount=function(){e.formData.paid_amount=e.formData.no_of_people*e.formData.no_of_hours*e.rate_list.first_rate},e.onSubmit=function(){e.processing=!0,o.postCall(e.formData,"/api/rest/store").then(t=>{t.success&&(e.formData={pay_type:1,no_of_hours:1,no_of_people:1,paid_amount:0},e.init(),setTimeout(function(){window.open(base_url+"/admin/rest/print/"+t.id,"_blank")},800)),e.processing=!1})}});