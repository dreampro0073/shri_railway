$(document).on("click",".datepicker",function(){$(this).datepicker({format:"dd-mm-yyyy",todayHighlight:!0,autoclose:!0}),$(this).datepicker("show")}),$(document).on("click",".datepicker1",function(){$(this).datepicker({format:"dd-mm-yyyy",todayHighlight:!0,autoclose:!0}),$(this).datepicker("show")});for(var category=null,i=0;i<catgories.length;i++){var categ=catgories[i];categ.canteen_item_id==canteen_item_id&&(category=categ)}var app=angular.module("app",["jcs-autoValidate","ngFileUpload","selectize"]);angular.module("jcs-autoValidate").run(["defaultErrorMessageResolver",function(t){t.getErrorMessages().then(function(t){t.patternInt="Please fill a numeric value",t.patternFloat="Please fill a numeric/decimal value"})}]),app.directive("convertToNumber",function(){return{require:"ngModel",link:function(t,a,e,o){o.$parsers.push(function(t){return null!=t?parseInt(t,10):null}),o.$formatters.push(function(t){return null!=t?""+t:null})}}}),app.service("DBService",function(e,t){this.getCall=function(t){return e({method:"GET",url:base_url+t}).then(function(t){if(console.log(t),200==t.status)return t.data.success,t.data})},this.postCall=function(t,a){return e({method:"POST",url:base_url+a,data:t}).then(function(t){if(200==t.status)return t.data.success,t.data})}}),app.controller("cloackCtrl",function(n,t,a,e,i,o){n.loading=!1,n.aadhar_flag=!1,n.aadhar_fetch=!1,n.aadhar_upload_flag=!1,n.newAadharFlag=!1,n.users=[],n.filter={page_no:1,export:0},n.aadhar_details={},n.formData={name:"",mobile:"",total_amount:0,paid_amount:0,balance_amount:0,hours_occ:0,check_in:"",check_out:"",no_of_bag:0,no_of_day:""},n.type=0,n.entry_id=0,n.check_shift="",n.pay_types=[],n.days=[],n.cloak_first_rate=0,n.cloak_second_rate=0,n.excel_loading="",n.d_count=0,n.productName="",n.init=function(){n.aadhar_fetch=!1,n.aadhar_flag=!1,n.newAadharFlag=!1,e.postCall(n.filter,"/api/cloak-rooms/init/"+n.type).then(t=>{t.success&&(n.pay_types=t.pay_types,n.l_entries=t.l_entries,n.days=t.days,n.cloak_first_rate=t.rate_list.first_rate,n.cloak_second_rate=t.rate_list.second_rate,n.d_count=t.d_count,n.updateCheckoutClass(),n.users=t.users,t.excel_link)&&(n.excel_loading=!1,window.open(t.excel_link,"_blank"))}),n.productName="",$("#productName").focus()},n.getData=t=>{n.filter.page_no=n.filter.page_no+t,n.init()},n.export=()=>{n.type=1,""!=n.filter.from_date&&""!=n.filter.to_date?(n.filter.export=1,n.excel_loading=!0,n.init()):alert("Please select both date")},n.filterClear=function(){n.filter={page_no:1,export:0},n.init()},n.edit=function(t){n.entry_id=t,e.postCall({entry_id:n.entry_id},"/api/cloak-rooms/edit-init").then(t=>{t.success&&(n.formData=t.l_entry,$("#exampleModalCenter").modal("show"))})},n.checkoutCloak=function(t){n.entry_id=t,1==confirm("Are you sure?")&&e.postCall({entry_id:n.entry_id},"/api/cloak-rooms/checkout-init/1").then(t=>{t.timeOut?(n.formData=t.l_entry,n.formData.checkout_by="",$("#checkoutCloakModel").modal("show")):(n.init(),n.filter.id="",alert(t.message))})},n.checkoutCloak1=function(){e.postCall({productName:n.productName},"/api/cloak-rooms/checkout-init/2").then(t=>{n.productName="",t.timeOut?(n.formData=t.l_entry,n.entry_id=t.l_entry.id,$("#checkoutCloakModel").modal("show")):(n.init(),alert(t.message),n.filter.id="")})},n.handleKeyPress=function(t){13===t.which?(n.checkoutCloak1(),n.scannedValue.trim()&&(n.scannedValue="")):n.scannedValue=(n.scannedValue||"")+t.key},n.add=function(){n.entry_id=0,$("#exampleModalCenter").modal("show")},n.hideModal=()=>{n.entry_id=0,n.formData={name:"",mobile:"",total_amount:0,paid_amount:0,balance_amount:0,hours_occ:0,check_in:"",check_out:"",no_of_bag:0,no_of_day:""},n.aadhar_fetch=!1,n.newAadharFlag=!1,n.aadhar_flag=!1,$("#exampleModalCenter").modal("hide"),$("#checkoutCloakModel").modal("hide")},n.onSubmit=function(){n.loading=!0,n.aadhar_fetch=!1,n.aadhar_flag=!1,n.newAadharFlag=!1,e.postCall(n.formData,"/api/cloak-rooms/store").then(t=>{t.success&&(n.loading=!1,$("#exampleModalCenter").modal("hide"),n.entry_id=0,n.formData={name:"",mobile:"",total_amount:0,paid_amount:0,balance_amount:0,hours_occ:0,check_in:"",check_out:"",no_of_bag:0,no_of_day:""},n.init(),setTimeout(function(){window.open(base_url+"/admin/cloak-rooms/print-unq/1/"+t.print_id,"_blank")},800)),n.loading=!1})},n.onCheckOut=function(){n.loading=!0,e.postCall(n.formData,"/api/cloak-rooms/checkout-store").then(t=>{t.success&&($("#checkoutCloakModel").modal("hide"),n.entry_id=0,n.formData={name:"",mobile:"",total_amount:0,paid_amount:0,balance_amount:0,hours_occ:0,check_in:"",check_out:"",no_of_bag:0,no_of_day:""},n.init(),setTimeout(function(){window.open(base_url+"/admin/cloak-rooms/print/"+t.id,"_blank")},800)),n.loading=!1,n.aadhar_fetch=!1,n.newAadharFlag=!1,n.aadhar_flag=!1})},n.changeAmount=function(){var t=n.cloak_first_rate,t=1<n.formData.no_of_day?(t+=(n.formData.no_of_day-1)*n.cloak_second_rate)*n.formData.no_of_bag:t*n.formData.no_of_day*n.formData.no_of_bag;0==n.entry_id?n.formData.paid_amount=t:n.formData.balance_amount=t-n.formData.paid_amount},n.delete=function(t){1==confirm("Are you sure?")&&e.getCall("/api/cloak-rooms/delete/"+t).then(t=>{alert(t.message),n.init()})},n.fetchAadhar=function(){n.formData.aadhar_no&&(n.aadhar_fetch=!0,e.postCall(n.formData,"/api/aadhar/fetch").then(t=>{t.success?(n.newAadharFlag=t.newAadharFlag,n.aadhar_details=t.details,console.log(t.details),n.newAadharFlag||(n.formData.aadhar_no=n.aadhar_details.aadhar_no,n.formData.name=n.aadhar_details.name,n.formData.mobile_no=+n.aadhar_details.mobile,n.aadhar_details.front?(n.formData.aadhar_front=n.aadhar_details.front,n.formData.aadhar_front_url=base_url+"/public/"+n.aadhar_details.front,n.formData.aadhar_back=n.aadhar_details.back,n.formData.aadhar_back_url=base_url+"/public/"+n.aadhar_details.back):n.newAadharFlag=!0),n.aadhar_flag=!0):n.aadhar_fetch=!1}))},n.uploadFile=function(t,a,e){e.pic_upload=!0;var o=base_url+"/api/aadhar/file-upload";i.upload({url:o,data:{media:t,name:a}}).then(function(t){t.data.success?(e[a]=t.data.path,e[a+"_url"]=t.data.url):alert(t.data.message),e.pic_upload=!1},function(t){console.log("Error status: "+t.status),e.pic_upload=!1},function(t){n.uploading_percentage=parseInt(100*t.loaded/t.total)+"%"})},n.removeFile=function(t,a){t[a]=""},n.updateCheckoutDarkClass=function(){for(var t=(new Date).getTime(),a=Math.floor(t/1e3),e=0;e<n.l_entries.length;e++)n.l_entries[e].check_class="",0==n.l_entries[e].checkout_status&&(a>n.l_entries[e].str_checkout_time?n.l_entries[e].check_class="t-danger":a+600>n.l_entries[e].str_checkout_time?n.l_entries[e].check_class="t-warning":n.l_entries[e].check_class="t-info")},n.updateCheckoutClass=function(){for(var t=(new Date).getTime(),a=Math.floor(t/1e3),e=0;e<n.l_entries.length;e++)n.l_entries[e].check_class="",0==n.l_entries[e].checkout_status&&(a>n.l_entries[e].str_checkout_time?n.l_entries[e].check_class="text-danger":a+600>n.l_entries[e].str_checkout_time?n.l_entries[e].check_class="text-warning":n.l_entries[e].check_class="")};var l=o(n.updateCheckoutClass,12e3);n.$on("$destroy",function(){l&&o.cancel(l)})}),app.controller("lockerCtrl",function(e,t,a,o){e.loading=!1,e.formData={name:"",mobile:"",paid_amount:0,no_of_day:"",locker_id:""},e.filter={},e.old_days=0,e.entry_id=0,e.check_shift="",e.pay_types=[],e.avail_lockers=[],e.days=[],e.rate_list={},e.sl_lockers=[],e.init=function(){o.postCall(e.filter,"/api/locker/init").then(t=>{t.success&&(e.pay_types=t.pay_types,e.l_entries=t.l_entries,e.avail_lockers=t.avail_lockers,e.days=t.days)})},e.filterClear=function(){e.filter={},e.init()},e.edit=function(t){e.entry_id=t,e.sl_lockers=[],o.postCall({entry_id:e.entry_id},"/api/locker/edit-init").then(t=>{t.success&&(e.formData=t.l_entry,e.sl_lockers=t.sl_lockers,e.rate_list=t.rate_list,e.old_days=t.l_entry.no_of_day,$("#exampleModalCenter").modal("show"))})},e.checkoutLoker=function(t){e.entry_id=t,1==confirm("Are you sure?")&&o.postCall({entry_id:e.entry_id},"/api/locker/checkout-init").then(t=>{t.timeOut?(e.formData=t.l_entry,$("#checkoutLokerModel").modal("show")):e.init()})},e.add=function(){e.entry_id=0,e.sl_lockers=[],o.postCall({entry_id:0},"/api/locker/edit-init").then(t=>{e.rate_list=t.rate_list,$("#exampleModalCenter").modal("show")})},e.hideModal=()=>{$("#exampleModalCenter").modal("hide"),$("#checkoutLokerModel").modal("hide"),e.entry_id=0,e.formData={name:"",mobile:"",total_amount:0,paid_amount:0,balance_amount:0}},e.onSubmit=function(){e.loading=!0,0==e.sl_lockers.length?alert("Please select at least one locker"):(e.formData.sl_lockers=e.sl_lockers,o.postCall(e.formData,"/api/locker/store").then(t=>{t.success&&(e.loading=!1,$("#exampleModalCenter").modal("hide"),e.entry_id=0,e.formData={name:"",mobile:"",paid_amount:0,no_of_day:"",locker_id:""},e.init(),setTimeout(function(){window.open(base_url+"/admin/locker/print/"+t.id,"_blank")},800)),e.loading=!1}))},e.onCheckOut=function(){e.loading=!0,o.postCall(e.formData,"/api/locker/checkout-store").then(t=>{t.success&&($("#checkoutLokerModel").modal("hide"),e.entry_id=0,e.formData={name:"",mobile:"",total_amount:0,paid_amount:0,balance_amount:0,hours_occ:0,check_in:"",check_out:""},e.init()),e.loading=!1})},e.changeAmount=function(){var t=e.rate_list.first_rate;1<e.formData.no_of_day&&(t+=(e.formData.no_of_day-1)*e.rate_list.second_rate),t=e.sl_lockers.length*t,0==e.entry_id?e.formData.paid_amount=t:e.formData.balance_amount=t-e.formData.paid_amount},e.delete=function(t){1==confirm("Are you sure?")&&o.getCall("/api/locker/delete/"+t).then(t=>{alert(t.message),e.init()})},e.insLocker=t=>{var a=e.sl_lockers.indexOf(t);-1==a?e.sl_lockers.push(t):e.sl_lockers.splice(a,1),e.changeAmount()}}),app.controller("massageCtrl",function(a,t,e,o){a.loading=!1,a.formData={paid_amount:0,time_period:"",no_of_person:1},a.filter={},a.m_id=0,a.m_entries=[],a.rate_list={},a.init=function(){o.postCall(a.filter,"/api/massage/init").then(t=>{a.pay_types=t.pay_types,a.m_entries=t.m_entries,a.rate_list=t.rate_list})},a.filterClear=function(){a.filter={},a.init()},a.edit=function(t){a.m_id=t,o.postCall({m_id:a.m_id},"/api/massage/edit-init").then(t=>{t.success&&(a.formData=t.m_entry,$("#massageModal").modal("show"))})},a.add=function(){$("#massageModal").modal("show")},a.hideModal=()=>{$("#massageModal").modal("hide"),a.entry_id=0,a.formData={paid_amount:0,time_period:0,no_of_person:1},a.init()},a.changeTime=function(){a.formData.paid_amount=0,10==a.formData.time_period&&(a.formData.paid_amount=a.rate_list.first_rate*a.formData.no_of_person),20==a.formData.time_period&&(a.formData.paid_amount=a.rate_list.second_rate*a.formData.no_of_person)},a.onSubmit=function(){a.loading=!0,o.postCall(a.formData,"/api/massage/store").then(t=>{t.success&&($("#massageModal").modal("hide"),a.entry_id=0,a.formData={paid_amount:0,time_period:0,no_of_person:1},a.init(),setTimeout(function(){window.open(base_url+"/admin/massage/print/"+t.id,"_blank")},800)),a.loading=!1})},a.delete=function(t){1==confirm("Are you sure")&&o.getCall("/api/massage/delete/"+t).then(t=>{alert(t.message),a.init()})}}),app.controller("sittingCtrl",function(o,t,a,e,n){o.loading=!1,o.formData={id:"",no_of_adults:0,no_of_baby_staff:0,no_of_children:0,name:"",mobile:"",total_amount:0,paid_amount:0,balance_amount:0,hours_occ:""},o.last_hour=1,o.filter={},o.checkout_number="",o.entry_id=0,o.pay_types=[],o.hours=[],o.rate_list={},o.checkout_process=!1,o.productName="",o.old_hr=0,o.checkout_th=0,o.setNullFormData=function(){o.formData={id:"",no_of_adults:0,no_of_baby_staff:0,no_of_children:0,name:"",mobile:"",total_amount:0,paid_amount:0,balance_amount:0,hours_occ:""},o.last_hour=1,o.old_hr=0},o.init=function(){o.setNullFormData(),e.postCall(o.filter,"/api/sitting/init").then(t=>{t.success&&(o.pay_types=t.pay_types,o.hours=t.hours,o.entries=t.entries,o.rate_list=t.rate_list,o.updateCheckoutClass()),$("#productName").focus()})},o.filterClear=function(){o.filter={},o.init()},o.edit=function(t){o.checkout_process=!1,o.entry_id=t,o.setNullFormData(),e.postCall({entry_id:o.entry_id},"/api/sitting/edit-init").then(t=>{t.success&&(o.last_hour=t.sitting_entry.hours_occ,o.formData=t.sitting_entry,o.old_hr=t.sitting_entry.hours_occ,$("#exampleModalCenter").modal("show"))})},o.newEditCheckout=function(t){o.checkout_th=1,o.entry_id=t,1==confirm("Are you sure?")&&(o.setNullFormData(),e.postCall({checkout_id:t,checkout_th:o.checkout_th},"/api/sitting/checkout-new/1").then(t=>{t.success?(alert(t.message),o.init(),o.checkout_th=0):(o.formData=t.entry,o.checkout_process=!0,setTimeout(function(){$("#checkoutModal").modal("show")},800))}))},o.newEditCheckout1=function(){o.checkout_th=2,o.setNullFormData(),e.postCall({productName:o.productName,checkout_th:o.checkout_th},"/api/sitting/checkout-new/2").then(t=>{o.productName="",$checkout_loading=!1,t.success?(alert(t.message),o.init(),o.checkout_th=0):(o.entry_id=t.entry.id,o.formData=t.entry,o.checkout_process=!0,setTimeout(function(){$("#checkoutModal").modal("show")},800))})},o.handleKeyPress=function(t){13===t.which?(o.newEditCheckout1(),o.scannedValue.trim()&&(o.scannedValue="")):o.scannedValue=(o.scannedValue||"")+t.key},o.add=function(){o.entry_id=0,o.setNullFormData(),o.checkout_process=!1,$("#exampleModalCenter").modal("show")},o.hideModal=()=>{o.entry_id=0,o.checkout_process=!1,o.setNullFormData(),$("#exampleModalCenter").modal("hide"),$("#checkoutModal").modal("hide")},o.onSubmit=function(){o.loading=!0,e.postCall(o.formData,"/api/sitting/store").then(t=>{t.success?($("#exampleModalCenter").modal("hide"),$("#checkoutModal").modal("hide"),o.entry_id=0,o.setNullFormData(),o.last_hour=1,o.init(),setTimeout(function(){window.open(base_url+"/admin/sitting/print-unq/1/"+t.print_id,"_blank")},800),o.checkout_process=!1):alert(t.message),o.loading=!1})},o.onSubmitCheckout=function(){o.loading=!0,o.formData.checkout_th=o.checkout_th,e.postCall(o.formData,"/api/sitting/checkout-store").then(t=>{t.success?($("#exampleModalCenter").modal("hide"),$("#checkoutModal").modal("hide"),o.entry_id=0,o.new_checkout_id=0,o.productName="",o.setNullFormData(),o.last_hour=1,o.checkout_th=0,o.init(),setTimeout(function(){window.open(base_url+"/admin/sitting/print-unq/2/"+t.print_id,"_blank")},800),o.checkout_process=!1):alert(t.message),o.loading=!1})},o.changeAmount=function(){var t;(o.formData.total_amount=0)<o.formData.hours_occ&&(t=o.formData.hours_occ-1,0<o.formData.no_of_adults&&(o.formData.total_amount+=o.rate_list.adult_rate*o.formData.no_of_adults,o.formData.total_amount+=t*o.rate_list.adult_rate_sec*o.formData.no_of_adults,console.log(o.formData.total_amount)),0<o.formData.no_of_children)&&(o.formData.total_amount+=o.rate_list.child_rate*o.formData.no_of_children,o.formData.total_amount+=t*o.rate_list.child_rate_sec*o.formData.no_of_children,console.log(o.formData.total_amount)),o.formData.balance_amount=o.formData.total_amount-o.formData.paid_amount,o.geValTime()},o.geValTime=function(){e.postCall({entry_id:o.entry_id,hours_occ:o.formData.hours_occ},"/api/sitting/cal-check").then(t=>{t.success&&(o.formData.show_valid_up=t.show_valid_up)})},o.updateCheckoutClass=function(){for(var t=(new Date).getTime(),a=Math.floor(t/1e3),e=0;e<o.entries.length;e++)o.entries[e].check_class="",0==o.entries[e].checkout_status&&(a>o.entries[e].str_checkout_time?o.entries[e].check_class="t-danger":a+600>o.entries[e].str_checkout_time?o.entries[e].check_class="t-warning":o.entries[e].check_class="t-info")};var i=n(o.updateCheckoutClass,12e3);o.$on("$destroy",function(){i&&n.cancel(i)})}),app.controller("reclinerCtrl",function(o,t,a,e,n){o.loading=!1,o.formData={id:"",no_of_adults:0,no_of_baby_staff:0,no_of_children:0,name:"",mobile:"",total_amount:0,paid_amount:0,balance_amount:0,hours_occ:""},o.last_hour=1,o.filter={},o.checkout_number="",o.entry_id=0,o.pay_types=[],o.hours=[],o.rate_list={},o.checkout_process=!1,o.productName="",o.old_hr=0,o.checkout_th=0,o.avail_recliners=[],o.sl_recliners=[],o.setNullFormData=function(){o.formData={id:"",no_of_adults:0,no_of_baby_staff:0,no_of_children:0,name:"",mobile:"",total_amount:0,paid_amount:0,balance_amount:0,hours_occ:""},o.last_hour=1,o.old_hr=0,o.sl_recliners=[]},o.init=function(){o.setNullFormData(),e.postCall(o.filter,"/api/recliners/init").then(t=>{t.success&&(o.pay_types=t.pay_types,o.hours=t.hours,o.entries=t.entries,o.rate_list=t.rate_list,o.avail_recliners=t.avail_recliners,o.updateCheckoutClass()),$("#productName").focus()})},o.filterClear=function(){o.filter={},o.init()},o.edit=function(t){o.checkout_process=!1,o.entry_id=t,o.setNullFormData(),e.postCall({entry_id:o.entry_id},"/api/recliners/edit-init").then(t=>{t.success&&(o.last_hour=t.rec_entry.hours_occ,o.formData=t.rec_entry,o.old_hr=t.rec_entry.hours_occ,o.sl_recliners=t.sl_recliners,$("#exampleModalCenter").modal("show"))})},o.newEditCheckout=function(t){o.checkout_th=1,o.entry_id=t,1==confirm("Are you sure?")&&(o.setNullFormData(),e.postCall({checkout_id:t,checkout_th:o.checkout_th},"/api/recliners/checkout-new/1").then(t=>{t.success?(alert(t.message),o.init(),o.checkout_th=0):(o.formData=t.entry,o.checkout_process=!0,setTimeout(function(){$("#checkoutModal").modal("show")},800))}))},o.newEditCheckout1=function(){o.checkout_th=2,o.setNullFormData(),e.postCall({productName:o.productName,checkout_th:o.checkout_th},"/api/recliners/checkout-new/2").then(t=>{o.productName="",$checkout_loading=!1,t.success?(alert(t.message),o.init(),o.checkout_th=0):(o.entry_id=t.entry.id,o.formData=t.entry,o.checkout_process=!0,setTimeout(function(){$("#checkoutModal").modal("show")},800))})},o.handleKeyPress=function(t){13===t.which?(o.newEditCheckout1(),o.scannedValue.trim()&&(o.scannedValue="")):o.scannedValue=(o.scannedValue||"")+t.key},o.add=function(){o.entry_id=0,o.setNullFormData(),o.checkout_process=!1,$("#exampleModalCenter").modal("show")},o.hideModal=()=>{o.entry_id=0,o.checkout_process=!1,o.setNullFormData(),$("#exampleModalCenter").modal("hide"),$("#checkoutModal").modal("hide")},o.onSubmit=function(){0==o.sl_recliners.length?alert("Please select at least one Recliner"):(o.formData.sl_recliners=o.sl_recliners,o.loading=!0,e.postCall(o.formData,"/api/recliners/store").then(t=>{t.success?($("#exampleModalCenter").modal("hide"),$("#checkoutModal").modal("hide"),o.entry_id=0,o.setNullFormData(),o.last_hour=1,o.init(),setTimeout(function(){window.open(base_url+"/admin/recliners/print-unq/1/"+t.print_id,"_blank")},800),o.checkout_process=!1):alert(t.message),o.loading=!1}))},o.onSubmitCheckout=function(){o.loading=!0,o.formData.checkout_th=o.checkout_th,e.postCall(o.formData,"/api/recliners/checkout-store").then(t=>{t.success?($("#exampleModalCenter").modal("hide"),$("#checkoutModal").modal("hide"),o.entry_id=0,o.new_checkout_id=0,o.productName="",o.setNullFormData(),o.last_hour=1,o.checkout_th=0,o.init(),setTimeout(function(){window.open(base_url+"/admin/recliners/print-unq/2/"+t.print_id,"_blank")},800),o.checkout_process=!1):alert(t.message),o.loading=!1})},o.changeAmount=function(){var t;(o.formData.total_amount=0)<o.formData.hours_occ&&(t=o.formData.hours_occ-1,o.formData.total_amount+=o.rate_list.second_rate*o.sl_recliners.length,o.formData.total_amount+=t*o.rate_list.second_rate*o.sl_recliners.length),o.formData.balance_amount=o.formData.total_amount-o.formData.paid_amount,o.geValTime()},o.geValTime=function(){e.postCall({entry_id:o.entry_id,hours_occ:o.formData.hours_occ},"/api/recliners/cal-check").then(t=>{t.success&&(o.formData.show_valid_up=t.show_valid_up)})},o.updateCheckoutClass=function(){for(var t=(new Date).getTime(),a=Math.floor(t/1e3),e=0;e<o.entries.length;e++)o.entries[e].check_class="",0==o.entries[e].checkout_status&&(a>o.entries[e].str_checkout_time?o.entries[e].check_class="t-danger":a+600>o.entries[e].str_checkout_time?o.entries[e].check_class="t-warning":o.entries[e].check_class="t-info")};var i=n(o.updateCheckoutClass,12e3);o.$on("$destroy",function(){i&&n.cancel(i)}),o.insRec=t=>{console.log(t);var a=o.sl_recliners.indexOf(t);-1==a?o.sl_recliners.push(t):o.sl_recliners.splice(a,1),o.changeAmount()}}),app.controller("shiftCtrl",function(a,t,e,o){a.loading=!1,a.sitting_data=[],a.cloak_data=[],a.canteen_data=[],a.massage_data=[],a.locker_data=[],a.recliner_data=[],a.scanning_data=[],a.pod_data=[],a.singal_cabin_data=[],a.double_bed_data=[],a.service_ids=[],a.clients=[],a.filter={input_date:"",user_id:"",client_id:""},a.clear=function(){a.filter={input_date:"",user_id:"",client_id:""},a.init()},a.changeFilter=function(){a.filter.user_id="",a.init()},a.serach=function(){a.init()},a.users=[],a.init=function(){a.loading=!1,o.postCall(a.filter,"/api/shift/init").then(t=>{t.success&&(a.users=t.users,a.clients=t.clients,a.service_ids=t.service_ids,a.sitting_data=t.sitting_data,a.cloak_data=t.cloak_data,a.canteen_data=t.canteen_data,a.massage_data=t.massage_data,a.locker_data=t.locker_data,a.recliner_data=t.recliner_data,a.scanning_data=t.scanning_data,a.pod_data=t.pod_data,a.singal_cabin_data=t.singal_cabin_data,a.double_bed_data=t.double_bed_data,a.total_shift_upi=t.total_shift_upi,a.total_shift_cash=t.total_shift_cash,a.total_collection=t.total_collection,a.last_hour_upi_total=t.last_hour_upi_total,a.last_hour_cash_total=t.last_hour_cash_total,a.last_hour_total=t.last_hour_total,a.change_data=t.chage_pay_type_data,a.check_shift=t.check_shift,a.shift_date=t.shift_date),a.loading=!0})}}),app.controller("userCtrl",function(o,t,a,n){o.loading=!1,o.formData={name:"",email:"",mobile:"",password:"",confirm_password:""},o.filter={},o.user_id=0,o.users=[],o.init=function(){n.postCall(o.filter,"/api/users/init").then(t=>{o.users=t.users})},o.filterClear=function(){o.filter={},o.init()},o.edit=function(t){o.user_id=t,n.postCall({user_id:o.user_id},"/api/users/edit-init").then(t=>{t.success&&(o.formData=t.user,$("#userModal").modal("show"))})},o.activeUser=function(a,e){1==confirm("Are you sure?")&&n.postCall({user_id:a.id},"/api/users/active-user").then(t=>{t.success&&(o.users[e].active=0==a.active?1:0),alert(t.message)})},o.hideModal=()=>{$("#userModal").modal("hide"),o.user_id=0,o.formData={name:"",email:"",mobile:"",password:"",confirm_password:""},o.init()},o.add=()=>{$("#userModal").modal("show"),o.user_id=0,o.formData={name:"",email:"",mobile:"",password:"",confirm_password:""}},o.onSubmit=function(){o.loading=!0,n.postCall(o.formData,"/api/users/store").then(t=>{t.success?(alert(t.message),$("#userModal").modal("hide"),o.formData={name:"",email:"",mobile:"",password:"",confirm_password:""},o.init()):alert(t.message),o.loading=!1})}}),app.controller("canteenItemsCtrl",function(a,t,e,o){a.loading=!1,a.formData={item_name:"",item_short_name:"",price:"",barcodevalue:""},a.stockData={stock:""},a.filter={barcodevalue_search:""},a.canteen_item_id=0,a.canteen_item_stock_id=0,a.canteen_items=[],a.init=function(){o.postCall(a.filter,"/api/canteen-items/init").then(t=>{a.canteen_items=t.canteen_items,$("#barcodevalue").focus()})},a.filterClear=function(){a.filter={barcodevalue_search:""},a.init()},a.edit=function(t){a.canteen_item_id=t,o.postCall({canteen_item_id:a.canteen_item_id},"/api/canteen-items/edit").then(t=>{t.success&&(a.formData=t.canteen_item,$("#exampleModalCenter").modal("show"))})},a.hideModal=()=>{$("#exampleModalCenter").modal("hide"),a.canteen_item_id=0,a.formData={item_name:"",item_short_name:"",price:"",barcodevalue:""},a.init()},a.add=()=>{a.canteen_item_id=0,a.formData={item_name:"",item_short_name:"",price:""},$("#barcodevalue").focus(),setTimeout(function(){$("#exampleModalCenter").modal("show")},300)},a.onSubmit=function(){console.log(a.formData),a.loading=!0,o.postCall(a.formData,"/api/canteen-items/store").then(t=>{t.success?(alert(t.message),$("#exampleModalCenter").modal("hide"),a.formData={item_name:"",item_short_name:"",price:"",barcodevalue:""},a.init()):alert(t.message),a.loading=!1})},a.initStocks=function(){a.filter.canteen_item_id=a.canteen_item_id,console.log(a.filter+"hello"),o.postCall(a.filter,"/api/canteen-items/stocks/init").then(t=>{a.item_stocks=t.item_stocks})},a.hideStockModal=()=>{$("#stockModal").modal("hide"),a.stockData={stock:""},a.initStocks()},a.addStock=()=>{$("#stockModal").modal("show"),a.stockData={stock:""}},a.editStock=function(t){a.canteen_item_stock_id=t,o.postCall({canteen_item_stock_id:a.canteen_item_stock_id},"/api/canteen-items/stocks/edit").then(t=>{t.success&&(a.stockData=t.item_stock,$("#stockModal").modal("show"))})},a.onStockSubmit=function(){a.loading=!0,a.stockData.canteen_item_id=a.canteen_item_id,o.postCall(a.stockData,"/api/canteen-items/stocks/store").then(t=>{t.success?(alert(t.message),$("#stockModal").modal("hide"),a.stockData={stock:""},a.initStocks()):alert(t.message),a.loading=!1})}}),app.controller("dailyEntryCtrl",function(l,t,a,e){l.loading=!1,l.formData={name:"",mobile:"",pay_type:"",total_amount:0,total_item:0,products:[{demo:""}]},l.products=[],l.product={canteen_item_id:0,item_name:"",quantity:1},l.filter={},l.entry_id=0,l.daily_entries=[],l.canteen_items=[],l.selectConfig={valueField:"barcodevalue",labelField:"item_name",maxItems:1,searchField:"item_name",create:!1,onInitialize:function(t){}},l.setNull=()=>{l.entry_id=0,l.formData={name:"",mobile:"",pay_type:"",total_amount:0,total_item:0,products:[{demo:""}]},l.products=[],l.product={canteen_item_id:0,item_name:"",quantity:1},l.productname=""},l.init=function(){e.postCall(l.filter,"/api/daily-entries/init").then(t=>{l.daily_entries=t.daily_entries,l.canteen_items=t.canteen_items,$("#productname").focus(),l.setNull()})},l.filterClear=function(){l.filter={},l.init()},l.edit=function(t){l.setNull(),l.entry_id=t,e.postCall({entry_id:l.entry_id},"/api/daily-entries/edit-init").then(t=>{t.success&&(l.formData=t.s_entry,$("#exampleModalCenter").modal("show"))})},l.hideModal=()=>{$("#exampleModalCenter").modal("hide"),l.entry_id=0,l.init()},l.add=()=>{$("#productname").focus(),l.setNull(),setTimeout(function(){$("#exampleModalCenter").modal("show")},300)},l.onSubmit=function(){l.formData.products=l.products,0==l.products.length?alert("Plese select at least one item."):""==l.formData.pay_type?alert("Plese select the pay type"):0==l.formData.total_amount?alert("Please select at least one item"):(l.loading=!0,e.postCall(l.formData,"/api/daily-entries/store").then(t=>{t.success?(alert(t.message),$("#exampleModalCenter").modal("hide"),l.products=[],l.init(),setTimeout(function(){window.open(base_url+"/admin/daily-entries/print/"+t.entry_id,"_blank")},800)):alert(t.message),l.loading=!1}))},l.onAddProdcut=()=>{for(var t=l.products,a=l.canteen_items.find(t=>t.barcodevalue==l.productname),e=(0<t.length&&t.findIndex(t=>t.barcodevalue==l.productname),a.paid_amount=+a.price,a.quantity=1,t.push(a),l.product={canteen_item_id:0,item_name:"",quantity:1},l.products=t,0),o=0,n=0;n<l.products.length;n++){var i=l.products[n];e+=i.paid_amount,o+=i.quantity}l.formData.total_amount=e,l.formData.total_item=o,l.productname="",$("#productname").focus()},l.removeItem=t=>{l.product=l.products[t],l.formData.total_amount=l.formData.total_amount-l.product.paid_amount,l.formData.total_item=l.products.length-1,l.products.splice(t,1)},l.handleKeyPress=function(t){13===t.which?(l.onAddProdcut(),l.scannedValue.trim()&&(l.scannedValue="")):l.scannedValue=(l.scannedValue||"")+t.key}}),app.controller("cloackPenltyCollectCtrl",function(a,t,e,o){a.loading=!1,a.formData={id:0,no_of_bag:0,total_bag:0},a.pData={},a.init=function(){o.postCall(a.filter,"/api/collect-cloak/init").then(t=>{t.success&&(a.l_entries=t.l_entries,a.penlty_list=t.penlty_list,a.penalty_sum=t.penalty_sum,a.c_sum=t.c_sum)})},a.filterClear=function(){a.filter={},a.init()},a.collectCloak=function(t){a.formData.id=t.id,a.formData.total_bag=t.total_bag,a.formData.no_of_bag=t.no_of_bag,$("#exampleModalCenter").modal("show")},a.onSubmit=function(){a.loading=!0,o.postCall(a.formData,"/api/collect-cloak/store").then(t=>{t.success?(alert(t.message),$("#exampleModalCenter").modal("hide"),a.formData={id:0,no_of_bag:0,total_bag:0},a.init()):alert(t.message),a.loading=!1})},a.onPSubmit=function(t){a.ploading=!0,a.pData=t,o.postCall(a.pData,"/api/collect-cloak/store-pen").then(t=>{t.success?(alert(t.message),a.pData={},a.init()):alert(t.message),a.ploading=!1})}}),app.controller("sittingCollectCtrl",function(a,t,e,o){a.loading=!1,a.formData={id:0,no_of_bag:0,total_bag:0},a.checked={},a.pData={},a.entries=[],a.init=function(){o.postCall(a.filter,"/api/collect-sitting/init").then(t=>{t.success&&(a.entries=t.entries,a.e_entries_list=t.e_entries_list,a.c_sum=t.c_sum,a.e_ent_sum=t.e_ent_sum,a.checked=t.checked)})},a.filterClear=function(){a.filter={},a.init()},a.hideModal=()=>{$("#exampleModalCenter").modal("hide")},a.collectSit=function(t){a.formData.id=t.id,a.formData.total_no_of_adults=t.no_of_adults,a.formData.no_of_adults=t.no_of_adults,a.formData.total_no_of_children=t.no_of_children,a.formData.no_of_children=t.no_of_children,a.formData.hours_occ=t.hours_occ,a.formData.total_hours=t.total_hours,$("#exampleModalCenter").modal("show")},a.onSubmit=function(){a.loading=!0,o.postCall(a.formData,"/api/collect-sitting/store").then(t=>{t.success?(alert(t.message),$("#exampleModalCenter").modal("hide"),a.formData={id:0,no_of_bag:0,total_bag:0},a.init()):alert(t.message),a.loading=!1})},a.onPSubmit=function(t){a.ploading=!0,a.pData=t,o.postCall(a.pData,"/api/collect-sitting/store-pen").then(t=>{t.success?(alert(t.message),a.pData={},a.init()):alert(t.message),a.ploading=!1})}}),app.controller("entryRoomCtrl",function(o,t,a,e,n){o.loading=!1,o.formData={name:"",mobile:"",paid_amount:0,no_of_day:"",locker_id:"",discount_amount:0},o.type=0,o.filter={},o.entry_id=0,o.check_shift="",o.pay_types=[],o.avail_pods=[],o.avail_cabins=[],o.avail_beds=[],o.hours=[],o.sl_pods=[],o.sl_cabins=[],o.sl_beds=[],o.total_amount=0,o.paid_amount=0,o.balance_amount=0,o.init=function(){e.postCall(o.filter,"/api/rooms/init/"+o.type).then(t=>{t.success&&(o.pay_types=t.pay_types,o.entries=t.entries,o.avail_pods=t.avail_pods,o.avail_cabins=t.avail_cabins,o.avail_beds=t.avail_beds,o.hours=t.hours,o.updateCheckoutClass())})},o.filterClear=function(){o.filter={},o.init()},o.edit=function(t){o.entry_id=t,o.sl_pods=[],o.sl_cabins=[],o.sl_beds=[],e.postCall({entry_id:o.entry_id},"/api/rooms/edit-init").then(t=>{t.success&&(console.log(t.l_entry.discount_amount+"hhhhh"),o.formData=t.l_entry,o.total_amount=t.l_entry.total_amount,o.sl_pods=t.sl_pods,o.sl_cabins=t.sl_cabins,o.sl_beds=t.sl_beds,$("#exampleModalCenter").modal("show"))})},o.checkoutLoker=function(t){o.entry_id=t,1==confirm("Are you sure?")&&e.postCall({entry_id:o.entry_id},"/api/rooms/checkout-init").then(t=>{t.timeOut?(o.formData=t.l_entry,$("#checkoutModal").modal("show")):o.init()})},o.add=function(){o.entry_id=0,o.sl_pods=[],o.sl_cabins=[],o.sl_beds=[],o.formData={name:"",mobile:"",paid_amount:0,total_amount:0,balance_amount:0,hours_occ:"",discount_amount:0},$("#exampleModalCenter").modal("show")},o.hideModal=()=>{$("#exampleModalCenter").modal("hide"),$("#checkoutModal").modal("hide"),o.entry_id=0,o.formData={name:"",mobile:"",paid_amount:0,total_amount:0,balance_amount:0,hours_occ:"",discount_amount:0},o.sl_pods=[],o.sl_beds=[],o.sl_cabins=[]},o.onSubmit=function(){o.formData.type=o.type,1==o.type&&0==o.sl_pods.length?alert("Please select at least one pods"):2==o.type&&0==o.sl_cabins.length?alert("Please select at least one single cabins"):3==o.type&&0==o.sl_beds.length?alert("Please select at least one double bed"):(o.loading=!0,1==o.type&&(o.formData.sl_pods=o.sl_pods),2==o.type&&(o.formData.sl_cabins=o.sl_cabins),3==o.type&&(o.formData.sl_beds=o.sl_beds),e.postCall(o.formData,"/api/rooms/store/"+o.type).then(t=>{t.success&&(o.loading=!1,$("#exampleModalCenter").modal("hide"),o.entry_id=0,o.formData={name:"",mobile:"",paid_amount:0,total_amount:0,balance_amount:0,hours_occ:"",discount_amount:0},o.sl_pods=[],o.sl_beds=[],o.sl_cabins=[],o.init(),setTimeout(function(){window.open(base_url+"/admin/rooms/print/"+t.id,"_blank")},800)),o.loading=!1}))},o.onCheckOut=function(){o.loading=!0,e.postCall(o.formData,"/api/rooms/checkout-store").then(t=>{t.success&&($("#checkoutModal").modal("hide"),o.entry_id=0,o.formData={name:"",mobile:"",total_amount:0,paid_amount:0,balance_amount:0,hours_occ:0,check_in:"",check_out:"",discount_amount:0},o.init(),setTimeout(function(){window.open(base_url+"/admin/rooms/print/"+t.entry_id,"_blank")},800)),o.loading=!1})},o.changeAmount=()=>{1==o.type&&o.changeAmountPod(),2==o.type&&o.changeAmountCabin(),3==o.type&&o.changeAmountBed()},o.changeAmountPod=()=>{var t=0;6==o.formData.hours_occ?t=299*o.sl_pods.length:12==o.formData.hours_occ?t=499*o.sl_pods.length:24==o.formData.hours_occ&&(t=799*o.sl_pods.length),o.total_amount=t,o.formData.total_amount=t,0==o.entry_id?(0<o.formData.discount_amount?o.formData.paid_amount=t-o.formData.discount_amount:o.formData.paid_amount=t,o.formData.balance_amount=t-o.formData.paid_amount):o.formData.balance_amount=t-(o.formData.paid_amount+o.formData.discount_amount)},o.changeAmountCabin=()=>{var t=0;6==o.formData.hours_occ?t=399*o.sl_cabins.length:12==o.formData.hours_occ?t=599*o.sl_cabins.length:24==o.formData.hours_occ&&(t=1199*o.sl_cabins.length),o.total_amount=t,o.formData.total_amount=t,0==o.entry_id?(0<o.formData.discount_amount?o.formData.paid_amount=t-o.formData.discount_amount:o.formData.paid_amount=t,o.formData.balance_amount=t-o.formData.paid_amount):o.formData.balance_amount=t-(o.formData.paid_amount+o.formData.discount_amount)},o.changeAmountBed=()=>{var t=0;6==o.formData.hours_occ?t=599*o.sl_beds.length:12==o.formData.hours_occ?t=899*o.sl_beds.length:24==o.formData.hours_occ&&(t=1699*o.sl_beds.length),o.total_amount=t,o.formData.total_amount=t,0==o.entry_id?(0<o.formData.discount_amount?o.formData.paid_amount=t-o.formData.discount_amount:o.formData.paid_amount=t,o.formData.balance_amount=t-o.formData.paid_amount):o.formData.balance_amount=t-(o.formData.paid_amount+o.formData.discount_amount),o.balance_amount=o.formData.balance_amount},o.delete=function(t){1==confirm("Are you sure?")&&e.getCall("/api/rooms/delete/"+t).then(t=>{alert(t.message),o.init()})},o.insPods=t=>{var a=o.sl_pods.indexOf(t);-1==a?o.sl_pods.push(t):o.sl_pods.splice(a,1),o.changeAmountPod()},o.insCabins=t=>{var a=o.sl_cabins.indexOf(t);-1==a?o.sl_cabins.push(t):o.sl_cabins.splice(a,1),o.changeAmountCabin()},o.insBeds=t=>{var a=o.sl_beds.indexOf(t);-1==a?o.sl_beds.push(t):o.sl_beds.splice(a,1),o.changeAmountBed()},o.disAmount=()=>{var t;0<o.formData.discount_amount&&0<o.formData.total_amount&&(0==o.entry_id?o.formData.paid_amount=o.total_amount-o.formData.discount_amount:(t=parseInt(o.formData.paid_amount)+parseInt(o.formData.discount_amount),o.formData.balance_amount=o.total_amount-t))},o.updateCheckoutClass=function(){for(var t=(new Date).getTime(),a=Math.floor(t/1e3),e=0;e<o.entries.length;e++)o.entries[e].check_class="",0==o.entries[e].checkout_status&&(a>o.entries[e].str_checkout_time?o.entries[e].check_class="t-danger":a+1200>o.entries[e].str_checkout_time?o.entries[e].check_class="t-warning":o.entries[e].check_class="t-info")};var i=n(o.updateCheckoutClass,12e3);o.$on("$destroy",function(){i&&n.cancel(i)})}),app.controller("allRoomEntryCtrl",function(a,t,e,o){a.loading=!1,a.filter={},a.entries=[{}],$l_entry={},a.init=function(){o.postCall(a.filter,"/api/rooms/init-all").then(t=>{t.success&&(a.entries=t.entries)})},a.initSingleEntry=function(t){o.postCall({entry_id:t},"/api/rooms/init-single-entry").then(t=>{t.success&&(a.l_entry=t.l_entry,$("#viewModal").modal("show"))})},a.hideModal=function(){$("#viewModal").modal("hide")},a.deleteEntry=function(t,a){console.log(t,a),o.getCall("/api/rooms/delete-e-entry/"+t+"/"+a).then(t=>{t.success,$("#viewModal").modal("hide")})},a.filterClear=function(){a.filter={},a.init()}}),app.controller("clientSettingCtrl",function(a,t,e,o){a.loading=!1,a.processing=!1,a.filter={},a.clients=[],a.init=function(){o.postCall(a.filter,"/api/clients/init-amount-setting").then(t=>{t.success&&(a.clients=t.clients)})},a.onSubmit=function(){a.processing=!0,o.postCall({clients:a.clients},"/api/clients/store-amount-setting").then(t=>{t.success&&a.init(),alert(t.message),a.processing=!1})},a.shiftStatus=function(){a.processing=!0,o.postCall(a.filter,"/api/clients/shift-status").then(t=>{t.success&&(a.shift_rows=t.shift_rows)})}}),app.controller("scanningCtrl",function(a,t,e,o){a.loading=!1,a.processing=!1,a.filter={},a.entries=[],a.incoming_types=[],a.item_types=[],a.rate_list=[],a.formData={name:"",paid_amount:0},a.init=function(){o.postCall(a.filter,"/api/scanning/init").then(t=>{t.success&&(a.entries=t.entries,a.incoming_types=t.incoming_types,a.item_types=t.item_types,a.rate_list=t.rate_list)})},a.add=()=>{$("#exampleModalCenter").modal("show")},a.filterClear=function(){a.filter={},a.init()},a.hideModal=()=>{$("#exampleModalCenter").modal("hide"),a.formData.name="",a.formData.paid_amount=0},a.onSubmit=function(){a.processing=!0,o.postCall(a.formData,"/api/scanning/store").then(t=>{t.success?(a.init(),a.hideModal(),setTimeout(function(){window.open(base_url+"/admin/scanning/print/"+t.print_id,"_blank")},800)):alert(t.message),a.processing=!1})},a.calAmount=()=>{var t=a.rate_list.find(t=>t.item_type_id==a.formData.item_type_id&&t.incoming_type_id==a.formData.incoming_type_id);a.formData.paid_amount=a.formData.no_of_item*t.rate}});